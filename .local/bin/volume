#!/bin/bash

volume() {
	# read -r -a amixer_out <<< "$(amixer get Master | awk -F'[][]' 'END{ print $2, $4 }')"
	vol=$(pamixer --get-volume)
	mute=$(pamixer --get-mute)

	if [ $mute == "false" ]; then
		echo "VVOL: $vol%"
	else
		echo "VVOL: mute"
	fi
}

volume
trap 'volume' SIGUSR1
trap 'rm /tmp/volume; exit' SIGINT SIGHUP SIGTERM

mkfifo /tmp/volume 2> /dev/null
while true
do
	read -p < /tmp/volume
done
